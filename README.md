# Проект сервиса фильмов

## 1 Установка

Для работы сайта необходим Node.js версии 11.0.0 и выше

1. Скопируйте репозиторий (либо скачайте в zip и раз-архивируйте) и введите команду:

```
npm install
```

Это установит зависимости

2. Создайте файл ```.env``` в корне проекта. 

Скопируйте туда содержимое файла ```.env.default``` (Он также находится в корне проекта). 

Это обязательно для взаимодействия клиента с сервером

2. Для запуска проекта введите: 

```
npm run dev
```

3. Это запустит сервер по адресу:

```
http://localhost:5173/
```

Откройте любой браузер и введите данный адрес для просмотра страницы и введите данный адрес.


## 2 Про API

Поскольку API дает только 200 запросов в день, то возможна ситуация, что сервер начнет отправлять 403 респонс 

В таком случае вы можете сами зарегистрироваться на их API и вставить в файле ```.env``` в переменную ```VITE_X_API_KEY``` свой ключ. Если у вас лимит не исчерпан, все снова будет работать (ну либо проверьте в Postman).

## 3 Про проект 

В проекте я использовал:

```TypeScript``` - для типизации кода и упрощения разработки

```React``` - для формирования SPA и следованию архитектуре MVP (Views + Presenters)

```Redux``` - для хранилища данных, также для следования архитектуре MVP (Models)

```React-Router``` - для роутинга на стороне клиента

```SCSS``` - для удобной стилизации 

```Vite``` - для автоматизации сборки и разработки

## 4 Страницы проекта


### Основные 

```/films``` - фильмы с бесконечным скроллом, выбор синхронизируемых с SearchParameters фильтров в правом верхнем углу 

```/favorites``` - избранное

```/favorites/detail/:id``` - детальная информация о фильме


На главной странице есть поиск, витрина из 5 избранных фильмов и витрина из 5 фильмов. 

При нажатии кнопки ```посмотреть все``` около надписи ```избранное``` произойдет переход на страницу ```/favorites```. Тут хранятся избранные фильмы. Тут реализован бесконечный скролл.

При нажатии кнопки ```посмотреть все``` около надписи ```Все``` произойдет переход на страницу ```/films```. На этой странице можно выбрать фильтры при нажатии на кнопку со значком "фильтра". Чтобы они применились, необходимо нажать кнопку применить, и они проставятся в searchParameters. Компонент получает фильтры из searchParameters и соответственно получает нужные фильмы в зависимости от searchParameters. В компоненте также реализован бесконечный скроллинг.

Если ввести значение в поле ввода поиска и нажать Enter, либо нажать на значок "лупы" в любом месте приложения, где поле ввода доступно, произойдет переход на страницу ```/search?query=[ввод]```, где ```[ввод]``` - это ввод пользователя. В зависимости от searchParameters (он же ввод пользователя, который с ним синхронизируется), на странице будет показаны фильмы с наименованиями, связанные с вводом пользователя. И тут реализован бесконечный скроллинг.

В галерее у любого фильма имеется название, рейтинг (его может не быть, поскольку с API рейтинги часто приходят не ```null```, а просто ```0```, что по факту не является валидным рейтингом, однако фильтровать получение таких фильмов, к сожалению, не предоставляется API (фильтр notNullFields распространяется только на ```null``` значения)), а также год выпуска и постер при его наличии у фильма.

В любой галерее фильмов можно нажать на фильм. При нажати на фильм в галерее произойдет переход на страницу ```/films/:id```, где ```:id``` - id нажатого фильма. Покажется модальное окно с крактой информацией о выбранном фильме - постер, название, год выпуска, жанр, описание.

При нажатии в модальном окне фильма кнопки ```Подробнее```, произойдет переход на страницу ```/films/detail/:id```. На данной странице будет ПОЛНАЯ информация о фильме: Постер, название, описание, рейтинг, дата выхода (прокат), список жанров, актеры, съемочная группа и другие.

Это основные части приложения.

В приложении также можно изменить тему (и немного залипнуть).

## 5 Структура проекта

src

| - ```api``` - функции для работы с API и утилитарные данные для API

| - ```assets``` - шрифты и изображения

| - ```features``` - стейт приложения и редьюсеры Redux

| - ```pages``` - компоненты React для отрисовки страницы 

| - ```presenters``` - презентеры, получает данные из стейта и передает их компонентам

| - ```services``` - глобальное хранилище данных 

| - ```shared```

| --- | -```lib``` - утилитарные функции и данные

| --- | -```ui``` - UI компоненты

| - ```styles``` - стили

| - ```widgets``` - компоненты виджетов (объединения UI компонентов)

| - ```App.tsx``` - Компонент со всеми роутами приложения

| - index.scss - глобальные стили проекта, переменные 

| - main.tsx - начало приложения, подключения провайдера Redux, роутера React-Router.

## Компоненты

В папке ```src/shared/ui``` лежат UI-компоненты. 
В папке ```src/shared/widgets``` лежат компоненты виджетов.

Среди них есть компонент GalleryInfinite, который используется для бесконечного скроллинга в роуте для избранных, всех и по поиску.

Также в виджетах есть компонент Filter, который отрисовывает фильтр в роуте ```/films```.

В папке ```src/pages``` лежат компоненты страниц - галерея фильмов с фильтрами, галерея избранных фильмов, галерея фильмов по вводу в поиске, главная страница, страница модального окна фильма и страница детальной информации о фильме . Они получают данные с презентеров. 

в папке ```src/presenters``` лежат презентеры. Они получают необходимые данные с хранилища Redux, отправляют данные в хранилища и передают данные страницам.

В главном компоненте App.tsx находятся роуты React-Router. Тут используется backgroundLocation, чтобы отрисовывать модальное окно выбранного фильма поверх страницы фильмов.

## Хранилище

Слайсы и асинхронные экшены Redux находятся  в папке src/features. Тут определено два слайса - для избранных фильмов, и для всех фильмов. 

В избранных хранятся id всех избранных фильмов и данные избранных фильмов, во всех фильмах хранятся фильмы, используемые в странице со всеми фильмами и фильтрами, а также для страницы с поисковыми резуьтатами. 

Для получения фильмов и избранных id с API используется Redux-thunk. Асинхронные экшены расположены в файлах ```thunk.ts```.

Главное хранилище расположено в ```src/services/store.ts```


# Итог

Все требования задания были выполнены:

1. Приложение отображает фильмы с бесконечным скроллом с подгрузкой по 50 фильмов при достижении низа списка в роуте ```/films```

У каждого фильма в ```/films``` есть название, год, рейтинг и постер, если он доступен.

2. В приложении есть возможность фильтровать список фильмов в роуте ```/films```
по жанру с выбором нескольких жанров, по рейтингу с диапазоном рейтинга, по году выпуска с диапазоном лет, начиная с 1990 года.

Фильтры синхронизируются с searchParameters и применяются при переходе на страницу по прямой ссылке с проставленными фильтрами.


3. Есть возможность детального просмотра информации о фильме по роуту ```films/detail/:id```, где ```id``` - уникальный идентификатор фильма, на странице фильма отображается постер, если он доступен, название фильма, описание фильма, рейтинг фильма, дата выхода (на странице ```films/detail/:id```- прокат -> премьера), список жанров. 

4. В приложении есть возможность добавления фильмов в список избранное по нажатию кнопки ```+ избранное``` как в роуте с модальным окном фильма ```films/:id``` где ```id``` - уникальный идентификатор фильма, так и на странице с детальной информацией о фильме ```films/detail/:id```. 

В приложении есть отдельная страница со списком избранных фильмов по роуту ```/favorites```

Список избранных фильмов сохраняется при перезагрузке страницы.

Добавление фильма происходит при подтверждении в кастомном модальном окне - оно появлвяется, когда пользователь нажимает кнопку ```+ избранное```. Если нажать на кнопку отмена или закрыть данное модально окно, то фильм не убдет добавлен в избранное.

Технические требования также соблюдены, использовал React и TypeScript, а также Redux, React-Router.


Помимо основных требований я также реализовал:

- Поиск фильмов по названию в поле ввода, поиск синхронизируется с searchParameters и применяются при переходе на страницу по прямой ссылке. Фильмы подгружаются в бесконечном скроллинге.
- Возможность удаления фильмов из избранного
- Дополнительное модальное окно для просмотра короткой информации о фильме 
- Темную и светлую тему сайта, тема меняется при выборе темы в кнопке в левом нижнем углу















